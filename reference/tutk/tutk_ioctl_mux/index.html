
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.3">
    
    
      
        <title>tutk_ioctl_mux.py - WyzeCam Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.e35208c4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tutk_ioctl_muxpy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="WyzeCam Documentation" class="md-header__button md-logo" aria-label="WyzeCam Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WyzeCam Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              tutk_ioctl_mux.py
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="WyzeCam Documentation" class="md-nav__button md-logo" aria-label="WyzeCam Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    WyzeCam Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Code Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Code Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Code Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" >
      
      <label class="md-nav__link" for="__nav_3_1">
        Wyze API
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Wyze API" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Wyze API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../wyze_api/wyze_api_functions/" class="md-nav__link">
        Functions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../wyze_api/wyze_api_models/" class="md-nav__link">
        Models
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      <label class="md-nav__link" for="__nav_3_2">
        IOTC API
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="IOTC API" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          IOTC API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../iotc/" class="md-nav__link">
        WyzeIOTC
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../iotc_session/" class="md-nav__link">
        WyzeIOTCSession
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../iotc_session_state/" class="md-nav__link">
        WyzeIOTCSessionState
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" checked>
      
      <label class="md-nav__link" for="__nav_3_3">
        Low Level API (TUTK)
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Low Level API (TUTK)" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Low Level API (TUTK)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tutk/" class="md-nav__link">
        tutk.py
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          tutk_ioctl_mux.py
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        tutk_ioctl_mux.py
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux" class="md-nav__link">
    TutkIOCtrlMux
  </a>
  
    <nav class="md-nav" aria-label="TutkIOCtrlMux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux-methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.send_ioctl" class="md-nav__link">
    send_ioctl()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.start_listening" class="md-nav__link">
    start_listening()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.stop_listening" class="md-nav__link">
    stop_listening()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.waitfor" class="md-nav__link">
    waitfor()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMuxListener" class="md-nav__link">
    TutkIOCtrlMuxListener
  </a>
  
    <nav class="md-nav" aria-label="TutkIOCtrlMuxListener">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMuxListener-methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMuxListener.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlFuture" class="md-nav__link">
    TutkIOCtrlFuture
  </a>
  
    <nav class="md-nav" aria-label="TutkIOCtrlFuture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlFuture-methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlFuture.result" class="md-nav__link">
    result()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_3" type="checkbox" id="__nav_3_3_3" >
      
      <label class="md-nav__link" for="__nav_3_3_3">
        tutk_protocol.py
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="tutk_protocol.py" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_3_3">
          <span class="md-nav__icon md-icon"></span>
          tutk_protocol.py
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tutk_protocol/" class="md-nav__link">
        Classes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tutk_protocol_commands/" class="md-nav__link">
        Commands
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux" class="md-nav__link">
    TutkIOCtrlMux
  </a>
  
    <nav class="md-nav" aria-label="TutkIOCtrlMux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux-methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.send_ioctl" class="md-nav__link">
    send_ioctl()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.start_listening" class="md-nav__link">
    start_listening()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.stop_listening" class="md-nav__link">
    stop_listening()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.waitfor" class="md-nav__link">
    waitfor()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMuxListener" class="md-nav__link">
    TutkIOCtrlMuxListener
  </a>
  
    <nav class="md-nav" aria-label="TutkIOCtrlMuxListener">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMuxListener-methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMuxListener.run" class="md-nav__link">
    run()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlFuture" class="md-nav__link">
    TutkIOCtrlFuture
  </a>
  
    <nav class="md-nav" aria-label="TutkIOCtrlFuture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlFuture-methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlFuture.result" class="md-nav__link">
    result()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="tutk_ioctl_muxpy">tutk_ioctl_mux.py</h1>


  <div class="doc doc-object doc-class">



<h2 id="wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux" class="doc doc-heading">
        <code>TutkIOCtrlMux</code>



</h2>

    <div class="doc doc-contents first">

      <p>An "IO Ctrl" interface for sending and receiving data over a control channel
built into an IOTC session with a particular device.</p>
<p>Use this to send and receive configuration data from the camera.  There are
many, many commands supported by the wyze camera over this interface, though
just a fraction of them have been reverse engineered at this point.  See
<a href="../tutk_protocol/#wyzecam.tutk.tutk_protocol.TutkWyzeProtocolMessage">TutkWyzeProtocolMessage</a>
and its subclasses for the supported commands.</p>
<p>This channel is used to authenticate the client with the camera prior to
streaming audio or video data.</p>
<p>See: <a href="../../iotc_session/#wyzecam.iotc.WyzeIOTCSession.iotctrl_mux">wyzecam.iotc.WyzeIOTCSession.iotctrl_mux</a></p>




  <div class="doc doc-children">







<h3 id="wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux-methods">Methods</h3>



  <div class="doc doc-object doc-method">



<h4 id="wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tutk_platform_lib</span><span class="p">,</span> <span class="n">av_chan_id</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h4>

    <div class="doc doc-contents ">

      <p>Initialize the mux channel.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>tutk_platform_lib</code></td>
        <td><code>CDLL</code></td>
        <td><p>the underlying c library used to communicate with the wyze device; see <a href="../tutk/#wyzecam.tutk.tutk.load_library">tutk.load_library</a>.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>av_chan_id</code></td>
        <td><code>c_int</code></td>
        <td><p>the channel id of the session this mux is created on.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>wyzecam/tutk/tutk_ioctl_mux.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tutk_platform_lib</span><span class="p">:</span> <span class="n">CDLL</span><span class="p">,</span> <span class="n">av_chan_id</span><span class="p">:</span> <span class="n">c_int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Initialize the mux channel.</span>

<span class="sd">    :param tutk_platform_lib: the underlying c library used to communicate with the wyze</span>
<span class="sd">                            device; see [tutk.load_library][wyzecam.tutk.tutk.load_library].</span>
<span class="sd">    :param av_chan_id: the channel id of the session this mux is created on.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tutk_platform_lib</span> <span class="o">=</span> <span class="n">tutk_platform_lib</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">av_chan_id</span> <span class="o">=</span> <span class="n">av_chan_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">queues</span><span class="p">:</span> <span class="n">DefaultDict</span><span class="p">[</span>
        <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="s2">&quot;Queue[Union[object, Tuple[int, int, int, bytes]]]&quot;</span>
    <span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">Queue</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">listener</span> <span class="o">=</span> <span class="n">TutkIOCtrlMuxListener</span><span class="p">(</span>
        <span class="n">tutk_platform_lib</span><span class="p">,</span> <span class="n">av_chan_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">queues</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.send_ioctl" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">send_ioctl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">ctrl_type</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Send a <a href="../tutk_protocol/#wyzecam.tutk.tutk_protocol.TutkWyzeProtocolMessage">TutkWyzeProtocolMessage</a>
to the camera.</p>
<p>This should be called after the listener has been started, by using the mux as a context manager:</p>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="n">session</span><span class="o">.</span><span class="n">ioctrl_mux</span><span class="p">()</span> <span class="k">as</span> <span class="n">mux</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">mux</span><span class="o">.</span><span class="n">send_ioctl</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>msg</code></td>
        <td><code>TutkWyzeProtocolMessage</code></td>
        <td><p>The message to send to the client. See <a href="../tutk_protocol_commands/">tutk_protocol.py Commands</a></p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ctrl_type</code></td>
        <td><code>int</code></td>
        <td><p>used internally by the iotc library, should always be <code>tutk.IOTYPE_USER_DEFINED_START</code>.</p></td>
        <td><code>256</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>TutkIOCtrlFuture</code></td>
      <td><p>a future promise of a response from the camera.  See <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlFuture">wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlFuture</a></p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>wyzecam/tutk/tutk_ioctl_mux.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">send_ioctl</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">msg</span><span class="p">:</span> <span class="n">TutkWyzeProtocolMessage</span><span class="p">,</span>
    <span class="n">ctrl_type</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">tutk</span><span class="o">.</span><span class="n">IOTYPE_USER_DEFINED_START</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TutkIOCtrlFuture</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Send a [TutkWyzeProtocolMessage][wyzecam.tutk.tutk_protocol.TutkWyzeProtocolMessage]</span>
<span class="sd">    to the camera.</span>

<span class="sd">    This should be called after the listener has been started, by using the mux as a context manager:</span>

<span class="sd">    ```python</span>
<span class="sd">    with session.ioctrl_mux() as mux:</span>
<span class="sd">        result = mux.send_ioctl(msg)</span>
<span class="sd">    ```</span>

<span class="sd">    :param msg: The message to send to the client. See</span>
<span class="sd">                [tutk_protocol.py Commands](../tutk_protocol_commands/)</span>
<span class="sd">    :param ctrl_type: used internally by the iotc library, should always be</span>
<span class="sd">                      `tutk.IOTYPE_USER_DEFINED_START`.</span>

<span class="sd">    :returns: a future promise of a response from the camera.  See [wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlFuture][]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">encoded_msg</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
    <span class="n">encoded_msg_header</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">tutk_protocol</span><span class="o">.</span><span class="n">TutkWyzeProtocolHeader</span><span class="o">.</span><span class="n">from_buffer_copy</span><span class="p">(</span>
            <span class="n">encoded_msg</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;SEND&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">encoded_msg_header</span><span class="p">,</span> <span class="n">encoded_msg</span><span class="p">[</span><span class="mi">16</span><span class="p">:])</span>
    <span class="n">errcode</span> <span class="o">=</span> <span class="n">tutk</span><span class="o">.</span><span class="n">av_send_io_ctrl</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tutk_platform_lib</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">av_chan_id</span><span class="p">,</span> <span class="n">ctrl_type</span><span class="p">,</span> <span class="n">encoded_msg</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">errcode</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">TutkIOCtrlFuture</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">errcode</span><span class="o">=</span><span class="n">errcode</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">msg</span><span class="o">.</span><span class="n">expected_response_code</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;no expected response code found&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">TutkIOCtrlFuture</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">TutkIOCtrlFuture</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">queues</span><span class="p">[</span><span class="n">msg</span><span class="o">.</span><span class="n">expected_response_code</span><span class="p">])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.start_listening" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">start_listening</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Start a separate thread listening for responses from the camera.</p>
<p>This is generally called by using the TutkIOCtrlMux as a context manager:</p>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="n">session</span><span class="o">.</span><span class="n">ioctrl_mux</span><span class="p">()</span> <span class="k">as</span> <span class="n">mux</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>
<p>If this method is called explicitly, remember to call <code>stop_listening</code> when
finished.</p>
<p>See: <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.stop_listening">wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.stop_listening</a></p>

        <details class="quote">
          <summary>Source code in <code>wyzecam/tutk/tutk_ioctl_mux.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">start_listening</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Start a separate thread listening for responses from the camera.</span>

<span class="sd">    This is generally called by using the TutkIOCtrlMux as a context manager:</span>

<span class="sd">    ```python</span>
<span class="sd">    with session.ioctrl_mux() as mux:</span>
<span class="sd">        ...</span>
<span class="sd">    ```</span>

<span class="sd">    If this method is called explicitly, remember to call `stop_listening` when</span>
<span class="sd">    finished.</span>

<span class="sd">    See: [wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.stop_listening][]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">listener</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.stop_listening" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">stop_listening</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Shuts down the separate thread used for listening for responses to the camera</p>
<p>See: <a href="#wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.start_listening">wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.start_listening</a></p>

        <details class="quote">
          <summary>Source code in <code>wyzecam/tutk/tutk_ioctl_mux.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">stop_listening</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shuts down the separate thread used for listening for responses to the camera</span>

<span class="sd">    See: [wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.start_listening][]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">queues</span><span class="p">[</span><span class="n">CONTROL_CHANNEL</span><span class="p">]</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">STOP_SENTINEL</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">listener</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMux.waitfor" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">waitfor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">futures</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Wait for the responses of one or more <code>TutkIOCtrlFuture</code>s.</p>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="n">session</span><span class="o">.</span><span class="n">ioctrl_mux</span><span class="p">()</span> <span class="k">as</span> <span class="n">mux</span><span class="p">:</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">mux</span><span class="o">.</span><span class="n">send_ioctl</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">f2</span> <span class="o">=</span> <span class="n">mux</span><span class="o">.</span><span class="n">send_ioctl</span><span class="p">(</span><span class="n">msg2</span><span class="p">)</span>

    <span class="n">resp1</span><span class="p">,</span> <span class="n">resp2</span> <span class="o">=</span> <span class="n">mux</span><span class="o">.</span><span class="n">waitfor</span><span class="p">([</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">])</span>
</code></pre></div>
<p>This allows you to wait for a set of <code>TutkIOCtrlFuture</code>s to respond in
any order, and allows you to send multiple commands to the camera without
waiting for each one to return before sending another.</p>
<p>If you are sending one command at a time, consider using
<code>TutkIOCtrlFuture.result()</code> directly:</p>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="n">session</span><span class="o">.</span><span class="n">ioctrl_mux</span><span class="p">()</span> <span class="k">as</span> <span class="n">mux</span><span class="p">:</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">mux</span><span class="o">.</span><span class="n">send_ioctl</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">resp1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
    <span class="n">f2</span> <span class="o">=</span> <span class="n">mux</span><span class="o">.</span><span class="n">send_ioctl</span><span class="p">(</span><span class="n">msg2</span><span class="p">)</span>
    <span class="n">resp2</span> <span class="o">=</span> <span class="n">f2</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
</code></pre></div>

        <details class="quote">
          <summary>Source code in <code>wyzecam/tutk/tutk_ioctl_mux.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">waitfor</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">futures</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">TutkIOCtrlFuture</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">TutkIOCtrlFuture</span><span class="p">]],</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;Wait for the responses of one or more `TutkIOCtrlFuture`s.</span>

<span class="sd">    ```python</span>
<span class="sd">    with session.ioctrl_mux() as mux:</span>
<span class="sd">        f1 = mux.send_ioctl(msg)</span>
<span class="sd">        f2 = mux.send_ioctl(msg2)</span>

<span class="sd">        resp1, resp2 = mux.waitfor([f1, f2])</span>
<span class="sd">    ```</span>

<span class="sd">    This allows you to wait for a set of `TutkIOCtrlFuture`s to respond in</span>
<span class="sd">    any order, and allows you to send multiple commands to the camera without</span>
<span class="sd">    waiting for each one to return before sending another.</span>

<span class="sd">    If you are sending one command at a time, consider using</span>
<span class="sd">    `TutkIOCtrlFuture.result()` directly:</span>

<span class="sd">    ```python</span>
<span class="sd">    with session.ioctrl_mux() as mux:</span>
<span class="sd">        f1 = mux.send_ioctl(msg)</span>
<span class="sd">        resp1 = f1.result()</span>
<span class="sd">        f2 = mux.send_ioctl(msg2)</span>
<span class="sd">        resp2 = f2.result()</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">unwrap_single_item</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">futures</span><span class="p">,</span> <span class="n">TutkIOCtrlFuture</span><span class="p">):</span>
        <span class="n">futures</span> <span class="o">=</span> <span class="p">[</span><span class="n">futures</span><span class="p">]</span>
        <span class="n">unwrap_single_item</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">futures</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">timeout</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">timeout</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span>
        <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span>
    <span class="p">):</span>
        <span class="n">all_success</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">future</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">futures</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
            <span class="k">except</span> <span class="n">Empty</span><span class="p">:</span>
                <span class="n">all_success</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># if we don&#39;t get all of them this pass, wait a short period before checking again</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">all_success</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">unwrap_single_item</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">results</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMuxListener" class="doc doc-heading">
        <code>TutkIOCtrlMuxListener</code>



</h2>

    <div class="doc doc-contents first">





  <div class="doc doc-children">







<h3 id="wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMuxListener-methods">Methods</h3>


  <div class="doc doc-object doc-method">



<h4 id="wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlMuxListener.run" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Method representing the thread's activity.</p>
<p>You may override this method in a subclass. The standard run() method
invokes the callable object passed to the object's constructor as the
target argument, if any, with sequential and keyword arguments taken
from the args and kwargs arguments, respectively.</p>

        <details class="quote">
          <summary>Source code in <code>wyzecam/tutk/tutk_ioctl_mux.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">timeout_ms</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Now listening on channel id </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">av_chan_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">control_channel_command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">queues</span><span class="p">[</span>
                <span class="n">CONTROL_CHANNEL</span>
            <span class="p">]</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">control_channel_command</span> <span class="o">==</span> <span class="n">STOP_SENTINEL</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;No longer listening on channel id </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">av_chan_id</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="k">return</span>
        <span class="k">except</span> <span class="n">Empty</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="n">actual_len</span><span class="p">,</span> <span class="n">io_ctl_type</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">tutk</span><span class="o">.</span><span class="n">av_recv_io_ctrl</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tutk_platform_lib</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">av_chan_id</span><span class="p">,</span> <span class="n">timeout_ms</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">actual_len</span> <span class="o">==</span> <span class="n">tutk</span><span class="o">.</span><span class="n">AV_ER_TIMEOUT</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">actual_len</span> <span class="o">==</span> <span class="n">tutk</span><span class="o">.</span><span class="n">AV_ER_SESSION_CLOSE_BY_REMOTE</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Connection closed by remote. Closing connection.&quot;</span>
            <span class="p">)</span>
            <span class="k">break</span>

        <span class="n">header</span><span class="p">,</span> <span class="n">payload</span> <span class="o">=</span> <span class="n">tutk_protocol</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RECV </span><span class="si">{</span><span class="n">header</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">queues</span><span class="p">[</span><span class="n">header</span><span class="o">.</span><span class="n">code</span><span class="p">]</span><span class="o">.</span><span class="n">put</span><span class="p">(</span>
            <span class="p">(</span><span class="n">actual_len</span><span class="p">,</span> <span class="n">io_ctl_type</span><span class="p">,</span> <span class="n">header</span><span class="o">.</span><span class="n">protocol</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlFuture" class="doc doc-heading">
        <code>TutkIOCtrlFuture</code>



</h2>

    <div class="doc doc-contents first">

      <p>Holds the result of a message sent over a TutkIOCtrlMux; a TutkIOCtrlFuture
is returned by <code>[TutkIOCtrlMux.send_ioctl][wyzecam.tutk.tutk_ioctrl_mox.TutkIOCtrlMux.send_ioctl]</code>,
and represents the value of a future response from the camera.  The actual contents
of this response should be retrieved by calling <code>result()</code>, below.</p>

<p><strong>Attributes:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>req</code></td>
        <td><code>TutkWyzeProtocolMessage</code></td>
        <td><p>The message sent to the camera that we are waiting for a response from</p></td>
      </tr>
      <tr>
        <td><code>errcode</code></td>
        <td><code>Optional[c_int]</code></td>
        <td><p>The resultant error code associated with this response</p></td>
      </tr>
      <tr>
        <td><code>resp_protocol</code></td>
        <td><code>Optional[int]</code></td>
        <td><p>The 2-byte protocol version of the header of the response</p></td>
      </tr>
      <tr>
        <td><code>resp_data</code></td>
        <td><code>Optional[bytes]</code></td>
        <td><p>The raw message sent from the camera to the client</p></td>
      </tr>
  </tbody>
</table>



  <div class="doc doc-children">







<h3 id="wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlFuture-methods">Methods</h3>



  <div class="doc doc-object doc-method">



<h4 id="wyzecam.tutk.tutk_ioctl_mux.TutkIOCtrlFuture.result" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span></code>


</h4>

    <div class="doc doc-contents ">

      <p>Wait until the camera has responded to our message, and return the result.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>block</code></td>
        <td><code>bool</code></td>
        <td><p>wait until the camera has responded, or the timeout has been reached. if False, returns immediately if we have already recieved a response, otherwise raise queue.Empty.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>timeout</code></td>
        <td><code>int</code></td>
        <td><p>the maximum number of milliseconds to wait for the response from the camera, after which queue.Empty will be raised.</p></td>
        <td><code>10000</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[Any]</code></td>
      <td><p>the result of <a href="../tutk_protocol/#wyzecam.tutk.tutk_protocol.TutkWyzeProtocolMessage.parse_response"><code>TutkWyzeProtocolMessage.parse_response</code></a> for the appropriate message.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>wyzecam/tutk/tutk_ioctl_mux.py</code></summary>
          <div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wait until the camera has responded to our message, and return the result.</span>

<span class="sd">    :param block: wait until the camera has responded, or the timeout has been reached.</span>
<span class="sd">                  if False, returns immediately if we have already recieved a response,</span>
<span class="sd">                  otherwise raise queue.Empty.</span>
<span class="sd">    :param timeout: the maximum number of milliseconds to wait for the response</span>
<span class="sd">                    from the camera, after which queue.Empty will be raised.</span>
<span class="sd">    :returns: the result of [`TutkWyzeProtocolMessage.parse_response`][wyzecam.tutk.tutk_protocol.TutkWyzeProtocolMessage.parse_response]</span>
<span class="sd">              for the appropriate message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resp_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">req</span><span class="o">.</span><span class="n">parse_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resp_data</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">errcode</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">tutk</span><span class="o">.</span><span class="n">TutkError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errcode</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected_response_code</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;no response code!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">queue</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Future created without error nor queue!&quot;</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="n">block</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
        <span class="n">msg</span><span class="p">,</span> <span class="nb">tuple</span>
    <span class="p">),</span> <span class="s2">&quot;Expected a iotc result, instead got sentinel!&quot;</span>
    <span class="n">actual_len</span><span class="p">,</span> <span class="n">io_ctl_type</span><span class="p">,</span> <span class="n">resp_protocol</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">msg</span>

    <span class="k">if</span> <span class="n">actual_len</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">tutk</span><span class="o">.</span><span class="n">TutkError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">errcode</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">io_ctl_type</span> <span class="o">=</span> <span class="n">io_ctl_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">resp_protocol</span> <span class="o">=</span> <span class="n">resp_protocol</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">resp_data</span> <span class="o">=</span> <span class="n">data</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">req</span><span class="o">.</span><span class="n">parse_response</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../tutk/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              tutk.py
            </div>
          </div>
        </a>
      
      
        <a href="../tutk_protocol/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Classes
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.4ea5477f.min.js"></script>
      
    
  </body>
</html>